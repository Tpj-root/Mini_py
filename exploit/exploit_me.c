#include <stdio.h>
#include <string.h>

void secret_function() {
    printf("ðŸ”¥ You hacked the program! ðŸ”¥\n");
}

int main() {
    char buffer[40];  // A buffer that is large enough for the overflow

    // Leak the memory address
    printf("Leaking memory address...\n");
    fflush(stdout);  // Ensure that the previous output is printed before

    // Use puts to leak the address
    puts("This is a test message!");

    printf("Enter a string: ");
    gets(buffer);  // Vulnerable function (no size check)
    
    printf("You entered: %s\n", buffer);
    return 0;
}
